{% extends 'veiculos/base.html' %}
{% load widget_tweaks %}

{% block title %}Registrar Novo Carro{% endblock %}

{% block content %}
<!-- Conteúdo específico da página de formulário -->
<h1 class="text-center">{{ form.instance.id|yesno:"Editar Veículo,Novo Veículo" }}</h1>

{% if error %}
<div class="alert alert-danger" role="alert">
    {{ error }}
</div>
{% endif %}

<form method="post" class="mt-4">
    {% csrf_token %}
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="id_marca" class="form-label">Marca</label>
            {{ form.marca|add_class:"form-control" }}
            <small id="modelos-disponiveis" class="form-text text-muted"></small>
        </div>
        <div class="col-md-4">
            <label for="id_modelo" class="form-label">Modelo</label>
            {{ form.modelo|add_class:"form-control" }}
        </div>
        <div class="col-md-4">
            <label for="id_ano" class="form-label">Ano</label>
            {{ form.ano|add_class:"form-control" }}
        </div>
        <div class="col-md-4">
            <label for="id_preco_diaria" class="form-label">Preço Diária</label>
            {{ form.preco_diaria|add_class:"form-control" }}
        </div>
        <div class="col-md-4">
            <label for="id_disponivel" class="form-label">Disponível</label>
            {{ form.disponivel|add_class:"form-check-input" }}
        </div>
    </div>
    <div class="d-flex justify-content-center">
        <button type="submit" class="btn btn-success mx-2">Salvar</button>
        <a href="/veiculos/" class="btn btn-secondary mx-2">Cancelar</a>
    </div>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const marcaField = document.getElementById('id_marca');
        const modeloField = document.getElementById('id_modelo');
        const modelosLabel = document.getElementById('modelos-disponiveis');

        const MARCAS_MODELOS = {
            'Ford': ['Fiesta', 'Focus', 'Mustang', 'Explorer', 'F-150'],
            'Chevrolet': ['Camaro', 'Silverado', 'Malibu', 'Equinox', 'Tahoe'],
            'Toyota': ['Corolla', 'Camry', 'RAV4', 'Highlander', 'Tacoma'],
            'Honda': ['Civic', 'Accord', 'CR-V', 'Pilot', 'Fit'],
            'Nissan': ['Altima', 'Sentra', 'Rogue', 'Pathfinder', 'Frontier'],
            'Volkswagen': ['Jetta', 'Passat', 'Tiguan', 'Golf', 'Atlas'],
            'Hyundai': ['Elantra', 'Sonata', 'Tucson', 'Santa Fe', 'Kona'],
            'Kia': ['Soul', 'Sportage', 'Sorento', 'Optima', 'Telluride'],
            'Jeep': ['Wrangler', 'Cherokee', 'Grand Cherokee', 'Compass', 'Renegade'],
            'Subaru': ['Outback', 'Forester', 'Impreza', 'Crosstrek', 'Ascent'],
            // ...remaining brands and models...
        };

        function updateModelosLabel() {
            const selectedMarca = marcaField.value;
            const modelos = MARCAS_MODELOS[selectedMarca] || [];
            modelosLabel.textContent = modelos.length > 0
                ? `Modelos disponíveis para ${selectedMarca}: ${modelos.join(', ')}`
                : 'Nenhum modelo disponível para a marca selecionada.';
        }

        marcaField.addEventListener('change', updateModelosLabel);
        updateModelosLabel(); // Initialize on page load
    });
</script>
{% endblock %}